---
layout: post
title: "51单片机开发系列三_数码管动态扫描显示"
date: "2020-01-31"
categories: 
  - "硬件"
---

数码管由于发光亮度强，指示效果好，非常适合于电梯楼层等数值显示应用中。对于一位数码管，可以采用静态显示，但实际应用中都是需要显示多位数值，数码管模块也只能动态显示，因此笔者在这里简单分析一下数码管动态扫描驱动的实现。

# 数码管原理概述

数码管由多个发光二极管封装在一起组成“8”字型的器件，引线已在内部连接完成，只引出它们的各个笔划，公共电极。数码管实际上是由七个发光管组成8字形构成的，加上小数点就是8个。这些段分别由字母a,b,c,d,e,f,g,dp来表示。数码管根据内部接法又可分成共阳极数码管和共阴极数码管。共阳数码管是指将所有发光二极管的阳极接到一起形成公共阳极(COM)的数码管(如下图SM\*10501)，共阴数码管是指将所有发光二极管的阴极接到一起形成公共阴极(COM)的数码管如下图(SM\*20501)。以共阳数码管为例，要想显示数字2，需把A、B、G、E、D段点亮，即公共端接上正电源，ABGED段阴极拉低，其余段拉高即可显示数字2。 [![]](http://127.0.0.1/?attachment_id=2929)

# 硬件设计

笔者此处以四位一体共阳数码管显示为例讲解其大概的硬件设计。

微控制器的IO口均不能流过过大的电流，LED点亮时有约10ma的电流，因此数码管的段码输出不要直接接单片机IO口，应先经过一个缓冲器74HC573。单片机IO口只需很小的电流控制74HC573即可间接的控制数码管段的显示，而74HC573输出也能负载约10ms的电流。设置数码管段的驱动电流为ID=15ma，这个电流点亮度好，并且有一定的裕度，即使电源输出电压偏高也不会烧毁LED，限流电阻值

R = (VCC- VCE – VOL – VLED) / ID

VCC为5v供电，VCE为三极管C、E间饱和电压，估为0.2v， VOL为74hc573输出低电平时电压，不同灌电流，此值不一样，估为0.2v，具体查看规格书，VLED为红光驱动电压，估为1.7v，根据上式可算出限流电阻为R = 200R。

数码管需接收逐个扫描信号，扫描到相应数码管时，对应的段码数据有效，即显示这个数码管的数值。笔者采用三线八线译码器74HC138来产生对应的扫描线信号。

当各个段码均点亮时，电流约15max8=90ma流过数码管公共端，74HC138无法直接驱动这个电流，需加三极管驱动，由于74HC138输出低电平有效，此处只有PNP三极管适合作为驱动。三极管基极电流设为2ma即可让三极管饱和，最大驱动电流远大于90ma。基极偏置电阻阻值

Rb =(VCC - VEB – VOL) / IB

VCC为5v供电，VEB为三极管E、B间的导通电压0.7v，VOL为74hc138输出低电平时电压，可根据规格书估为0.3v，故Rb = 2k即可。 [![]](http://127.0.0.1/?attachment_id=2930)

#  驱动实现

数码管段码接P0口，位码接P2口第0~2位。对于LED显示器都是有一个刷新频率的，同样对于数码码动态扫描也需要一个扫描频率。扫描频率下限为50HZ，低于一定的扫描频率，显示会闪烁。频率过高，则亮度较差且占用cpu资源。一般整个数码管扫描一遍时间为约10ms较合适(即扫描频率100HZ)，我们用的是四位数码管，每个数码管点亮时间为2ms，扫描一遍时间为8ms。为保证这个刷新频率，通过是通过定时器来周期性进行数码管刷新。笔者在此以四位一体数码管实现秒表计数显示为例来作代码开发。

 

# 引用

[https://blog.csdn.net/huang20083200056/article/details/21472247](https://blog.csdn.net/huang20083200056/article/details/21472247)
