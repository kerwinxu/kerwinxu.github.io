---
layout: post
title: "pandas之diff_shift"
date: "2018-04-11"
categories: 
  - "python"
---

```
import pandas as pd
import numpy as np

```

In \[2\]:

```
df = pd.DataFrame(np.arange(24).reshape(6,4),index=pd.date_range(start='20170101',periods=6),columns=['A','B','C','D'])  

```

In \[3\]:

```
df

```

Out\[3\]:

|  | A | B | C | D |
| --- | --- | --- | --- | --- |
| 2017-01-01 | 0 | 1 | 2 | 3 |
| 2017-01-02 | 4 | 5 | 6 | 7 |
| 2017-01-03 | 8 | 9 | 10 | 11 |
| 2017-01-04 | 12 | 13 | 14 | 15 |
| 2017-01-05 | 16 | 17 | 18 | 19 |
| 2017-01-06 | 20 | 21 | 22 | 23 |

# shift函数

In \[4\]:

```
df.shift(2,axis=0) # 时间索引不动，数据下移

```

Out\[4\]:

|  | A | B | C | D |
| --- | --- | --- | --- | --- |
| 2017-01-01 | NaN | NaN | NaN | NaN |
| 2017-01-02 | NaN | NaN | NaN | NaN |
| 2017-01-03 | 0.0 | 1.0 | 2.0 | 3.0 |
| 2017-01-04 | 4.0 | 5.0 | 6.0 | 7.0 |
| 2017-01-05 | 8.0 | 9.0 | 10.0 | 11.0 |
| 2017-01-06 | 12.0 | 13.0 | 14.0 | 15.0 |

In \[5\]:

```
df.shift(2,axis=0,freq='2D') # 数据不动，时间索引下移

```

Out\[5\]:

|  | A | B | C | D |
| --- | --- | --- | --- | --- |
| 2017-01-05 | 0 | 1 | 2 | 3 |
| 2017-01-06 | 4 | 5 | 6 | 7 |
| 2017-01-07 | 8 | 9 | 10 | 11 |
| 2017-01-08 | 12 | 13 | 14 | 15 |
| 2017-01-09 | 16 | 17 | 18 | 19 |
| 2017-01-10 | 20 | 21 | 22 | 23 |

In \[6\]:

```
df.shift(2,axis=1) # 时间索引不动，数据右移

```

Out\[6\]:

|  | A | B | C | D |
| --- | --- | --- | --- | --- |
| 2017-01-01 | NaN | NaN | 0.0 | 1.0 |
| 2017-01-02 | NaN | NaN | 4.0 | 5.0 |
| 2017-01-03 | NaN | NaN | 8.0 | 9.0 |
| 2017-01-04 | NaN | NaN | 12.0 | 13.0 |
| 2017-01-05 | NaN | NaN | 16.0 | 17.0 |
| 2017-01-06 | NaN | NaN | 20.0 | 21.0 |

In \[7\]:

```
df.shift(2,axis=1,freq='2D') # 数据不动，时间索引下移

```

Out\[7\]:

|  | A | B | C | D |
| --- | --- | --- | --- | --- |
| 2017-01-05 | 0 | 1 | 2 | 3 |
| 2017-01-06 | 4 | 5 | 6 | 7 |
| 2017-01-07 | 8 | 9 | 10 | 11 |
| 2017-01-08 | 12 | 13 | 14 | 15 |
| 2017-01-09 | 16 | 17 | 18 | 19 |
| 2017-01-10 | 20 | 21 | 22 | 23 |

# diff函数

In \[8\]:

```
df.diff(periods=2,axis=0)  

```

Out\[8\]:

|  | A | B | C | D |
| --- | --- | --- | --- | --- |
| 2017-01-01 | NaN | NaN | NaN | NaN |
| 2017-01-02 | NaN | NaN | NaN | NaN |
| 2017-01-03 | 8.0 | 8.0 | 8.0 | 8.0 |
| 2017-01-04 | 8.0 | 8.0 | 8.0 | 8.0 |
| 2017-01-05 | 8.0 | 8.0 | 8.0 | 8.0 |
| 2017-01-06 | 8.0 | 8.0 | 8.0 | 8.0 |

In \[10\]:

```
# 等同于如上的
df-df.shift(2,axis=0)

```

Out\[10\]:

|  | A | B | C | D |
| --- | --- | --- | --- | --- |
| 2017-01-01 | NaN | NaN | NaN | NaN |
| 2017-01-02 | NaN | NaN | NaN | NaN |
| 2017-01-03 | 8.0 | 8.0 | 8.0 | 8.0 |
| 2017-01-04 | 8.0 | 8.0 | 8.0 | 8.0 |
| 2017-01-05 | 8.0 | 8.0 | 8.0 | 8.0 |
| 2017-01-06 | 8.0 | 8.0 | 8.0 | 8.0 |
