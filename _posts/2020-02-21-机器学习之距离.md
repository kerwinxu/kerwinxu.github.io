---
layout: post
title: "机器学习之距离"
date: "2020-02-21"
categories: 
  - "数学"
  - "理论知识"
---

在机器学习中，用距离来衡量2个样品之间的相似度。

[![no img]](http://127.0.0.1/?attachment_id=3052)

如上是欧式距离、曼哈顿距离，切比雪夫距离的示意图

 

曼哈顿距离（Manhattan Distance）

曼哈顿距离，说的是从街区中的一个十字路口到另一个十字路口所经过的街区距离，因此也称为城市街区距离。下图中给出了曼哈顿距离的形象说明，当我们开车从街区的一个十字路口（O）到了另一个十字路口（E）所经过的街区距离为：a+b，这就是曼哈顿距离。

[![no img]](http://127.0.0.1/?attachment_id=3051)

O、E两点之间直线段距离是我们生活中常说的两个地方（O、E）之间的距离，而在实际街区中的情形，车辆无法从O沿直线开到E，除非具备像蜘蛛侠一样的飞行本领可以穿越其中的大楼，这就是曼哈顿距离的由来。

# 简单例子

假如现在有三个人A、B和C（即样本A、样本B和样本C），我们需要以性格、爱好这两个属性为依据来判断他们的相似度，A、B、C的综合属性值则表示为：A（性格1，爱好1）、B（性格2，爱好2）、C（性格3，爱好3）。

我们设定上述性格、爱好等每个分量特征属性的取值范围为0—10分。以性格活泼、爱好打球具体属性为例，若性格很活泼，分值为10，若性格不活泼，分值则为0分，其余介于很活泼和不活泼之间的，则取0—10之间的分值；同理，若很爱打球，分值为10分，不爱打球，分值则为0分，其余介于很爱打球和不爱打球之间的，则取0—10之间的分值。

针对性格活泼、爱好打球的两项特征，假设A、B、C三人的取值分别如下：

[![no img]](http://127.0.0.1/?attachment_id=3056)

我们现以上述A、B、C三个样本A（4，4）、B（9，5）、C（6，1）投影到二维坐标上，分别计算A、B样本之间和A、C样本之间各自的欧氏距离、曼哈顿距离和切比雪夫距离，参照二维坐标投影图，计算结果如下：

[![no img]](http://127.0.0.1/?attachment_id=3057)

[![no img]](http://127.0.0.1/?attachment_id=3058)

由上述例子的计算结果可知，尽管欧氏距离、曼哈顿距离和切比雪夫距离各自的定义和计算都不相同，但它们最终衡量的结果是相一致的。这三类距离也可归为闵氏距离。

闵氏距离也称闵可夫斯基距离，根据其变参数p的不同，可以归为不同类型的距离，比如：曼哈顿距离（p=1）；欧氏距离（p=2）；切比雪夫距离（p→∞）。

我们已经知道欧氏距离的实质是两个样本同一特征分量值差值的平方和，然后再开平方根，这里的平方指数就是闵氏距离的变参数p取2，如果平方指数（即2次方）换成其他次方（比如1，3，4次方等等），那就是其他类闵氏距离。

因此，也可以将闵氏距离看成是欧氏距离指数的推广距离，两者实质特点对比如下：

[![no img]](http://127.0.0.1/?attachment_id=3059)

余弦夹角

除了以上各类常见的闵氏距离，还有一种较常用的距离，那就是夹角余弦。夹角余弦根据两个样本向量的夹角余弦值大小来确定样本的相似性。余弦值越接近1，余弦夹角就越接近0度，两个向量越相似。

现我们仍以简单的平面二维坐标的来了解夹角余弦的本质。以上述A、B、C三个样本A（4，4）、B（9，5）、C（6，1）为例，其在二维平面坐标的投影点如下图所示，从坐标原点O出发分别指向A、B、C三个点的线段（OA、OB、OC）则为A、B、C三个样本点的向量，A、B之间的向量夹角则为θ1，A、C之间的向量夹角则为θ2，根据三角形AOB的边长可计算出θ1的余弦值，根据三角形AOC的边长可计算出θ2的余弦值。θ1、θ2夹角示意图及其计算式如下表所示：

[![no img]](http://127.0.0.1/?attachment_id=3061)

夹角余弦计算公式（二维）

根据两个样本的坐标值计算

[![no img]](http://127.0.0.1/?attachment_id=3062)

**余弦值取值范围为\[-1，1\]。余弦值越大，夹角越小。**

**A、B样本夹角余弦值**

向量OA与OB之间的夹角余弦值

[![no img]](http://127.0.0.1/?attachment_id=3063)

**A、C样本夹角余弦值**

向量OA与OC之间的夹角余弦值

[![no img]](http://127.0.0.1/?attachment_id=3064)

**可以得出θ1<θ2，从而得出A和B相似度高。**

通过对比发现，以上夹角余弦相似度的判断结果与欧氏距离等的判断结果正好相反。这是为什么呢？这是因为欧氏距离和余弦相似度各自的计算方式和衡量角度不相同，欧氏距离关注的是两点之间的绝对距离，而夹角余弦相似度注重的是两个向量在方向上的差异，而非距离。如下二维坐标图中，有A、C两个样本，欧氏距离关注的是AC两点的直线段距离，与OA、OC线段长度密切相关；而夹角余弦则是关注OA线段与OC线段重合需扫过的角度（θ）大小，与OA、OC线段长度无关。因此，夹角余弦相似度是整体方向性上的判断，而欧氏距离则是各分量特征的绝对差值判断。

[![no img]](http://127.0.0.1/?attachment_id=3065)

我们还可以用两个等边三角形的例子来具体了解两者的实质差别。假设有两个等边三角形T1和T2，其边长分别为8和4，现以三个边长为分量特征属性来表征三角形，其在三维空间的投影坐标点分别为T1(8, 8, 8)、T2(4, 4, 4)。由边长数值可知，两个等边三角形虽然边长差距大，但形状完全相似。从其投影坐标点可知，由于T1、T2各个边长分量差值相同，两个坐标点在三维空间坐标上投影方向完全相同。对T1、T2之间的欧氏距离及夹角余弦作对比如下：

[![no img]](http://127.0.0.1/?attachment_id=3066)

[![no img]](http://127.0.0.1/?attachment_id=3067)

从以上对比分析可以看出，欧氏距离和余弦相似度各自的评判标准不同，得出的结论也可能完全不同，因此，两者可根据适用的场合选择采用。欧氏距离适用于需要从每个分量特征差距中体现差异的分析，如通过用户行为指标分析用户价值相似度。余弦相似度更适用于综合性的导向评价，如通过用户对内容评分来区分用户兴趣的相似度等，余弦相似度也常用于计算两个文本之间的相似度。

以上各类常见的物理几何空间距离不仅容易理解，而且方便好用，在样本各个维度数据完整好的情况下具有较理想的预判效果。但同时这几类距离也存在着一些明显的不足，如缺乏考虑各分量之间的相关性影响、各分量特征侧重排序等。

例如上述的例子中，也许需要对性格、爱好、人生观、价值观、家庭背景等分量特征进行侧重排序，又或者人生观这一分量特征会对价值观、爱好等分量特征有影响。如需考虑分量相关性、个体相对于总体的比重等相关因素，更多则是采用基于概率统计的分布距离，较常用的有：马氏距离、巴氏距离、杰卡德相似系数、皮尔逊系数等。这些距离的计算多涉及统计学及概率论知识，因而相对较复杂。

但无论是物理几何空间距离，还是基于概率统计的分布距离，它们的中心思想都是统一的，那就是距离越近越相似。

# 总结

 

- 欧式距离（Euclidean Distance）
    - $ d = \\sqrt{\\sum\\limits\_{i=1}^{n}(x\_{i1}-x\_{i2})^2} ; n维的$
- 曼哈顿距离
    - $ d = \\sum\\limits\_{i=1}^{n}| x\_{i1}-x\_{i2}|$
- 切比雪夫距离（Chebyshev Distance）
    - $ d = \\max (|x\_{i1}-x\_{i2}|)$
- 闵氏距离（Minkowski Distance）
    - $ d(p) = \\sqrt\[p\]{\\sum\\limits\_{i=1}^{n}(x\_{i1}-x\_{i2})^p} ; n维的$
    - 跟欧式距离的区别就是，这里是开p次方和p次方根，而欧式是平方和平方根。
- 夹角余弦(Cosine)
