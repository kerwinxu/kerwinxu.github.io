---
layout: post
title: "朴素贝叶斯概率"
date: "2020-03-09"
categories: 
  - "数学"
  - "理论知识"
---

# 前言

贝叶斯定理是统计学中非常重要的一个定理，以贝叶斯定理为基础的统计学派在统计学世界里占据着重要的地位，和概率学派从事件的随机性出发不同，贝叶斯统计学更多地是从观察者的角度出发，事件的随机性不过是观察者掌握信息不完备所造成的，观察者所掌握的信息多寡将影响观察者对于事件的认知。

## 条件概率和全概率

条件概率： 事件A在另一个事件B已经发生下的概率，计做 $latex P(A|B)$,A和B可能是相互独立的事件，也可能不是，

$latex P(A|B)=\\frac{P(A\\cap B)}{P(B)}$

- $latex P(A\\cap B$ 表示A和B事件同时发生的概率，如果A和B是独立的事件，则 $latex P(A|B)=\\frac{P(A \\cap B )}{P(B)}=\\frac{P(A)\\times P(B)}{P(B)}=P(A)$
    - 上面的推导过程反过来证明了如果 A 和 B 是相互独立的事件，那么事件 A 发生的概率与 B 无关。

稍微改变一下

$latex P(A\\cap B)= P(A|B)\\times P(B)$

考虑到先验条件 B 的多种可能性，这里引入全概率公式：

$latex P(A)= P(A\\cap B)+ P(A\\cap B^{C})= P(A|B)\\times P(B) +P(A|B^{C})\\times P(B^{C})$

这里 $latex B^{C}$是事件B的互补条件，从结果上说是B的补集 $latex P(B) + P(B^{C})=1$

条件概率和全概率公式可以通过韦恩图形象地表示出来：

[![](/assets/image/default/a2563ee05ac7ddb743e2dc10f88fc9ac_720w.png)](http://127.0.0.1/?attachment_id=3174)

## 贝叶斯公式

在条件概率和全概率的基础上，很容易推导出贝叶斯公式：

$latex P(A|B)= \\frac{P(A\\cap B)}{P(B)}=\\frac{P(B|A)\\times P(A)}{P(B)}=\\frac{P(B|A)\\times P(A)}{P(B|A)\\times P(A)+P(B|A^{C})\\times P(A^{C})}$

# 概念

条件独立公式，$latex P(X,Y) =P(X)P(Y)$

条件概率公式 ，$latex P(Y|X) = P(X,Y)/P(X)$

给出贝叶斯公式 $$P(B|A) = \\frac{P(A|B)P(B)}{P(A)}$$

换成分类任务的表达式是 $$P(类别|特征) = \\frac{P(特征|类别)P(类别)}{P(特征)}$$

然后全概率可以表示为 $latex P(X) = \\sum\\limits\_{k}P(X|Y =Y\_k)P(Y\_k) 其中\\sum\\limits\_{k}P(Y\_k)=1$

从而得到 $$P(Y\_k|X) = \\frac{P(X|Y\_k)P(Y\_k)}{\\sum\\limits\_{k}P(X|Y =Y\_k)P(Y\_k)}$$

# 例子

[![](/assets/image/default/20180310163354182.png)](http://127.0.0.1/?attachment_id=3128)

现在给我们的问题是，如果一对男女朋友，男生想女生求婚，男生的四个特点分别是不帅，性格不好，身高矮，不上进，请你判断一下女生是嫁还是不嫁？

这是典型的二分类问题，按照朴素贝叶斯的求解，转换为P(嫁|不帅、性格不好、矮、不上进)和P(不嫁|不帅、性格不好、矮、不上进)的概率，最终选择嫁与不嫁的答案。

这里我们根据贝特斯公式:

$$P(嫁|不帅、性格不好、矮、不上进）=\\frac{P(嫁）\*P（不帅、性格不好、矮、不上进|嫁）}{P（不帅、性格不好、矮、不上进）}$$

 

$$P(不嫁|不帅、性格不好、矮、不上进）=\\frac{P(不嫁）\*P（不帅、性格不好、矮、不上进|不嫁）}{P（不帅、性格不好、矮、不上进）}$$

 

经代入贝叶斯公式可得

P(嫁|不帅、性格不好、矮、不上进)=(1/864) / (1/864+1/18)=1/49=2.04% P(不嫁|不帅、性格不好、矮、不上进)=(1/18) / (1/864+1/18)=48/49=97.96%

 

# 一个很有意思的例子

在生活中，几乎所有人（包括统计学者）都会无意识地将两个事件的后验概率混淆，即：

$latex P(A|B)=P(B|A)$

最经典的一个例子就是疾病检测，假设某种疾病在所有人群中的感染率是0.1%，医院现有的技术对于该疾病检测准确率为 99%（已知患病情况下， 99% 的可能性可以检查出阳性；正常人 99% 的可能性检查为正常），如果从人群中随机抽一个人去检测，医院给出的检测结果为阳性，那么这个人实际得病的概率是多少？

很多人会脱口而出 "99%"，但真实概率远低于此，因为他们把两个后验概率搞混了，如果用 A 表示这个人患有该疾病，用 B 表示医院检测的结果是阳性，那么  $latex P(B|A)=99%$ 表示的是「已知一个人得病的情况下医院检测出阳性的概率」，而我们现在问的是「对于随机抽取的这个人，已知检测结果为阳性的情况下这个人患病的概率」，即  $latex P(A|B)$。

我们可以用贝叶斯定理来计算这个人实际得病的概率：

$latex P(A|B)= \\frac{P(B|A)\\times P(A)}{P(A|A)\\times P(A)+ P(B|A^{C})\\times P(A^{C})}$

- $latex P(A)=0.001$,被检测者患病的概率
- $latex P(A^C)=0.999$,被检测者没有患病的概率。
- $latex P(B|A) = 0.99$ , 已知患病的情况，检测为阳性的概率。
- $latex P(B|A^C) = 0.01$ , 已知没有患病的情况，检测为阳性的概率。

将上面的概率代入到贝叶斯公式中，可得：

$latex P(A|B)= \\frac{P(B|A)\\times P(A)}{P(A|A)\\times P(A)+ P(B|A^{C})\\times P(A^{C})}=\\frac{0.99\\times 0.001}{0.99\\times 0.001+0.01\\times 0.999}\\approx 0.09$

这个公式在这里的实际意义是什么？让我们用图来解释（图中概率经过四舍五入，考虑到图片的尺寸，面积并没有和概率严格对应起来）：

[![](/assets/image/default/73cf004fc2e29421ad356c5147e90052_720w.png)](http://127.0.0.1/?attachment_id=3175)

从贝叶斯的角度来看，随意选取的一个被测者，由于信息并不充分，未检测之前有假阳性、真阳性、假阴性和真阴性四种可能，这些可能性由检测技术和该疾病的感染率决定，当检测结果为阳性的时候，只剩下真阳性和假阳性两种可能，而真阳性的概率仅为假阳性的十分之一，贝叶斯公式在这里的实际意义是：

$latex P(A|B)= \\frac{真阳性}{真阳性+假阳性}=\\frac{0.001}{0.01+0.001} \\approx 0.09$

 

即使被医院检测为阳性，实际患病的概率其实还不到10%，有很大可能是假阳性，往往需要复检来确定是否真的患病，让我们再来计算初检和复检结果都为阳性时，患病的可能性。假设两次检查的准确率相同，都是99%，这里令 B 为第一次检测结果为阳性，C 为第二次检测结果为阳性，A 为被检测者患病，那么两次检测结果都是阳性患病的概率可以表示为：

$latex P(A|(B\\cap C))=\\frac{P\\left((B\\cap C)|A\\right) \\times P(A)}{P((B\\cap C)|A) \\times P(A) + P((B\\cap C)|A^C) \\times P(A^C)}$

其中

- $latex P(A)=0.001$,被检测者患病的概率
- $latex P(A^C)=0.999$,被检测者没有患病的概率。
- $latex P((B\\cap C)|A)=0.99\\times 0.99 = 0.9801$ ,已知患病情况下连续两次检测结果为阳性的概率
- $latex P((B\\cap C)|A^C)=0.01\\times 0.01 = 0.0001$ ,已知患病没有情况下连续两次检测结果为阳性的概率

带入可得

$latex P(A|(B\\cap C))=\\frac{P\\left((B\\cap C)|A\\right) \\times P(A)}{P((B\\cap C)|A) \\times P(A) + P((B\\cap C)|A^C) \\times P(A^C)}=\\frac{0.9801\\times 0.001}{0.9801\\times 0.001 + 0.0001\\times 0.999} \\approx0.9$

 

可见复检结果大大提高了检测的可信度，联系上面的图，复检的意义在于大幅减少假阳性的可能（0.01 -> 0.0001）从而提高阳性检测的准确性。

# 引用

- [朴素贝叶斯算法原理小结](https://www.cnblogs.com/pinard/p/6069267.html)
- [Think Bayes - 我所理解的贝叶斯定理](https://zhuanlan.zhihu.com/p/22467549)
